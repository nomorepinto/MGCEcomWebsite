<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Shop Item - Start Bootstrap Template</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        body {
            flex: 1 0 auto;
            display: flex;
            flex-direction: column;
            padding-top: 10vh; /* Add padding to prevent content from hiding behind navbar */
        }

        main {
            flex: 1 0 auto;
        }

        footer {
            flex-shrink: 0;
        }

        .image-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.5;
            z-index: 10;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.3s ease;
        }

        .image-nav-btn:hover {
            opacity: 1;
        }

        .image-nav-left {
            left: 10px;
        }

        .image-nav-right {
            right: 10px;
        }

    </style>
    <link href="css/custom-style.css" rel="stylesheet" />
</head>
<body>
    <main>
    <!-- Navigation-->
    <nav id="navbar"></nav>
    <!-- Product section-->
    <section class="py-5">
        <div class="container px-4 px-lg-5 my-5">
            <div class="row gx-4 gx-lg-5 align-items-center">
                <div class="col-md-6">
                    <div class="position-relative">
                        <img class="card-img-top mb-md-0" src="assets/Products/keychain2d.png" alt="MGC Keychain 2D" id="item-image" />
                        
                        <!-- Navigation Buttons -->
                        <button class="btn btn-dark image-nav-btn image-nav-left" id="prev-image">
                            <i class="bi bi-chevron-left"></i>
                        </button>
                        <button class="btn btn-dark image-nav-btn image-nav-right" id="next-image">
                            <i class="bi bi-chevron-right"></i>
                        </button>
                    </div>

                    <div class="dflex fixedthumb pt-3">
                        <img class="card-img-top mb-3" src="assets/Products/keychain2d.png" alt="MGC Keychain 2D" id="img-2" />
                        <img class="card-img-top mb-3" src="assets/Products/keychain2d.png" alt="MGC Keychain 2D" id="img-3" />
                        <img class="card-img-top mb-3" src="assets/Products/keychain2d.png" alt="MGC Keychain 2D" id="img-4" />
                        <img class="card-img-top mb-3" src="assets/Products/keychain2d.png" alt="MGC Keychain 2D" id="img-5" />
                    </div>
                </div>

                <div class="col-md-6">
                    <h1 class="display-5 fw-bolder" id="item-title">MGC Keychain 2D</h1>
                    <div class="fs-5 mb-5"><span id="item-price">â‚±40.00</span></div>
                    <p class="lead" id="item-description">A sleek and stylish 2D keychain representing MGC pride. Perfect for everyday carry. <br> 
                                                    <br>Dimensions: 23mm x 5mm</p>
                    
                    <button class="btn btn-outline-dark flex-shrink-0 my-5" type="button" id="add-to-cart-button">
                        <i class="bi-cart-fill me-1"></i>
                        Add to Cart
                    </button>
                </div>
            </div>
        </div>
    </section>
    </main>
     <!-- Footer-->
    <footer class="py-5 bg-black">
        <div class="container"><p class="m-0 text-center text-white" id="footer-text">:)</p></div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/itemlist.js"></script>
    <script src="js/cartfunctions.js"></script>
    <script src="js/componentUpdater.js"></script>
    <script>
        $(document).ready(function () {

            // Fetch item details based on URL parameter
            const url = new URLSearchParams(window.location.search);
            const itemID = parseInt(url.get('id')); 
            const product = items[itemID];

            if (product) {
                $("#item-title").text(product.title);
                $("#item-price").text(product.price);
                $("#item-image").attr("src", product.imageArray.image1);
                $("#item-description").text(product.description);
                $("#img-2").attr("src", product.imageArray.image2);
                $("#img-3").attr("src", product.imageArray.image3);
                $("#img-4").attr("src", product.imageArray.image4);
                $("#img-5").attr("src", product.imageArray.image5);
            }
            
            // add to cart button functionality
            $('#add-to-cart-button').attr('onclick', `addToCart(${itemID})`);
            
            // image change functionality (not finished)
            // image change functionality - convert imageArray object to array
            let imageQueue = [
                product.imageArray.image1 || product.image,
                product.imageArray.image2,
                product.imageArray.image3,
                product.imageArray.image4,
                product.imageArray.image5
            ].filter(img => img); // Remove any undefined values

            $('#prev-image').click(function() {
                // Rotate backwards
                let lastImage = imageQueue.pop();
                imageQueue.unshift(lastImage);
                
                if (imageQueue[0]) $('#item-image').attr('src', imageQueue[0]);
                if (imageQueue[1]) $('#img-2').attr('src', imageQueue[1]);
                if (imageQueue[2]) $('#img-3').attr('src', imageQueue[2]);
                if (imageQueue[3]) $('#img-4').attr('src', imageQueue[3]);
                if (imageQueue[4]) $('#img-5').attr('src', imageQueue[4]);
            });

            $('#next-image').click(function() {
                let currentImage = imageQueue.shift();
                imageQueue.push(currentImage);
                if (imageQueue[0]) $('#item-image').attr('src', imageQueue[0]);
                if (imageQueue[1]) $('#img-2').attr('src', imageQueue[1]);
                if (imageQueue[2]) $('#img-3').attr('src', imageQueue[2]);
                if (imageQueue[3]) $('#img-4').attr('src', imageQueue[3]);
                if (imageQueue[4]) $('#img-5').attr('src', imageQueue[4]);
            });

            // update cart quantity on page load
            updateCartQuantity();
        });
    </script>
</body>
</html>
